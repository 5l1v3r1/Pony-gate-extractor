VERSION 5.00
Begin VB.Form PonyGate 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Pony gate extractor v0.1 - xylitol@temari.fr"
   ClientHeight    =   4545
   ClientLeft      =   135
   ClientTop       =   3720
   ClientWidth     =   8055
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   Picture         =   "Frm.frx":0000
   ScaleHeight     =   4545
   ScaleWidth      =   8055
   StartUpPosition =   2  'CenterScreen
   Begin VB.TextBox Text4 
      Height          =   375
      Left            =   3120
      TabIndex        =   5
      Text            =   "Text4"
      Top             =   7920
      Visible         =   0   'False
      Width           =   615
   End
   Begin VB.CommandButton Command1 
      Caption         =   "C"
      Height          =   280
      Left            =   7560
      TabIndex        =   4
      Top             =   2520
      Width           =   375
   End
   Begin VB.TextBox Text3 
      Height          =   1215
      Left            =   120
      Locked          =   -1  'True
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   2
      Top             =   1200
      Width           =   7815
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Left            =   720
      Locked          =   -1  'True
      TabIndex        =   1
      Top             =   2520
      Width           =   6735
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   4005
      Left            =   9120
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   0
      Text            =   "Frm.frx":48E4
      Top             =   960
      Visible         =   0   'False
      Width           =   6615
   End
   Begin VB.Image Image1 
      Height          =   975
      Left            =   120
      Picture         =   "Frm.frx":48FC
      Top             =   120
      Width           =   7815
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      BackStyle       =   0  'Transparent
      Caption         =   "Gate:"
      Height          =   255
      Left            =   120
      TabIndex        =   3
      Top             =   2520
      Width           =   495
   End
End
Attribute VB_Name = "PonyGate"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'                                                      `,'.
'                                               `.;+#@@@@+
'                                     `   `;+@@@@@@@@@@@@
'                                  `;@@@@@@@@@@@@@@@@@@@
'                          `.;#@@@@@@@@@@@@@@@@@@@@@@@@`
'                     .'#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,
'                   `;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;
'                   '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+
'                  +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
'                `+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#`
'               '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@' `
'              ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@' `@.
'           ` :@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@# `@@@:
'            ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @@@@@;
'           .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#` @@@@@@@;
'          .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@. @@@@@@@#@,
'         .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;`@@@@@@@#+`@
'        :@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'`@@@@@@+.'+'@@@@:`
'       '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+ @@@@@@;+`'#.@@'@@#
'      ##@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@# @@@@@@.@.' #@: ``:@;
'     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#: @@@@@@+``@.,.@, +'`+#
'    @@@@@@@@@@@@@@@@@@@@@@@@@@@+,` `.'#@@@@@#. + :## @. +` `#@
'   #@@@@@@@@@@@@@@@@@@@@@'.   .'@@@@@@@@@@@;@#` ;`@`':: '+@.`@:
'  +@@@@@@@@@@@@@@@@@,   ,'@@@@@@@@@@@@@@@#@  #@`: `##`@ @  @ @@
'  #@@@@@@@@@@#':.     @@@@@@@@@@@@@@@@@@;`@   #@`+ @, ; @  .;`@;
'           ;#         +@@@@@@@@@@@@@@@'# @`   `@@` ;.:;`# . @ #@
'           ,@         ,@@@@@@@@@@@@@# `@'#     ;'@+ @#++@ ``+,.@
'           `@          @@@@@@@@@@+;+` @:#       @,` @#++,`# ## @+
'            @          @@@@@@@#@@ #++#+#        `##'#+@`:,@ #@ @#
'            @          @@@@#@#:@+#,@@@+;   `#@`  #'.,@# :   @@ @@
'            @`         .@@;;,::,@,@+@',  `@'      @``@:    ..@ +@
'            @:          + ',#`@@@`@+@.` ##      + ;'#@,    +`@ :@
'            #'           ##,@;   .@@. .@;     `.   @ #.     `@ :#
'            '#           `@@#@`. +: `,##     `, `  '.@    `@#``@`
'            ,@            :,@@,.##   `+ .  `'@@.+   @#     `  +@'
'             @             #+     `   `  +'+@@@+    +@     .#@.+@.
'             @              +    ``       `@@@@     `#         `@@
'             @@,            :` :@@+,         .      ,            @#
'            @@@@.           `@:#@@.;                #            `@;
'            @@@@#            @++#@.`                              `@`
'            @@@@@             @`.@@ '   ,                          ;@
'            @@@@@             `#    #   #                           #@
'            @@@@@              '+   :   +                            @@
'            @@@@@`              @:   , `'                            #:'#
'            @@@@@,               @   :`;                            #.  ,@;
'            #@@@@:               .#   ;@                           #`    `:@:
'            +@@@@'                +#  `      `.                   ;`     ` @@@@:`
'            ;@@@@#                 #:      `+;+                  ,,        @@@@@@@@;``
'            ,@@@@@                 `@` +;`@``@       `          .,        :@@@@@@@@@@@@'`
'            .@@@@@                  `@` @@#;#       `,         `,         @@@@@@@@@@@@@@@@@@. `
'            .@@@@@                   .@``#@@        +         :.         `@@@@@@@@@@@@@@@@@@@@@@.
'            ,@@@@@                    ,#           '#`       '`          :@@@@@@@@@@@@@@@@@@@@@@@@#.
'             @@@@@`                    ;#`       `'` #      `#           @@@@@@@@@@@@@@@@@@@@@@@@@@@@`
'             +@@@                       '#`     `+ `@@'      @`         .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+.
'             '#@@                       `#@    `# `@@@..     '#`        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'             ,@@`                         @@  #' `@@@@  `'   +`#        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;+@@...@#
'              ':                          `@@#`  @@@@@   `,  @ `+      :@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;;@@@,;:@@#`
'                                               .@@@@@@,   @. #  ,'     @@@@@@@@@@@@@@@@@@@@@@@@@@@++@@@@`@@@.;+@@@'
'                                              :@@@@@@@@   :+`.`  ''   .:@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@.@@#`.#@@@#
'                                             ,@@@@@@@@@.  . #`:   @. `@+@@@@@@@@@@@@@@@@@@@@@@@@@+#@@@@@@,##@@'`'@@@#
'                                            .@@@@@@@@@@@  . `.@    @`,'@@@@@@@@@@@@@@@@@@@@@@@@@# @@@@@@@@ #@#.@ +@@@#
'                                           .@@@@@@@@@@@@` :  +#    `@@.@@@@@@@@@@@@@@@@@@@@@@@@@@,@@@@@@+@#+@@@`@.@@@@:
'                                          `@@@@@@@@@@@@@+ :   #     `'@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@'@@ @@@.@:`@@@@
'                                         ,@@@@@@@@@@@@@@@ ,           @@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@'#@@#@@@`@`;@@@@
'                                        ,@@@@@@@@@@@@@@@@#;          @@@@@@@@@@@@@@@@@@@@@@@@@@@`@@@@@@@@.@@:@@#.#@@@@@#:
'                                       ,@@@@@@@@@@@@@@@@@@@         `@@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@@:#@#@@@@.@`#@@@@
'                                      ,@@@@@@@@@@@@@@@@@@@@         @@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@@@@:@@#@@@@@@.@@@@
'                                   #@@@@@@@@@@@@@@@@@@@@@@@'       :@@@@@@@@@@@@@@@@@@@@@@@@@@@`@@@@@@@@@@.@@@@@@''@#;@@@'
'                                  .@@@@@@@@#@@@@@@@@@@@@@@@@       @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@:@@@@@@`@@#@@@@
'                                  @@@@@@@#``@@@@@@@@@@@@@@@@`     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@ @@@@@@`@@#@@@@.
'                                  @@@@@@#   @@@@@@@@@@@@@@@@;    ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.@@@@@@@@@@@+#@@@@@'@@@@@@@@
'                                  @@@@@#` . @@@@@@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@@@@@@,@@@@@@@@@@@@@@.
'                                  `@@@@ '.: @@@@@@@@@@@@@@@@@  `+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#;@@@@@@@@@@@@`@@@@@@@@@@@@@@@
'                                  `@@@ @@`# #@@@@@@@@@@@@@@@@, `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+'@@@@@@@@@@@@+#@@@@@@@@@@@@@@`
'                                  `@@@#@+ @ #@@@@@@@@@@@@@@@@#`@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@++@@@@@@@@@@@@@:@@@@@@@@@@@@@@:
'                                  `@@@@@`+#`:@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'#@@@@@@@@@@@@@ @@@@@@@@@@@@@@@
'                                  `@@@@@ @@:.@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;#@@@@@@@@@@@@@:@@@@@@@@@@@@@@@
'                                   @@@@+`@@;`@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@@@@@@@@@+@@@@@@@@@@@@@@`
'                                  ;@@@@ :@@+ @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,@@@@@@@@@@@@@@@'@@@@@@@@@@@@@@@
'                                 `@@@@@:@@@@ @@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,@@@@@@@@@@@@@@@'@@@@@@@@@@@@@@@
'                                 #@@@@@@@@@@ @@@@@@@@@@@@@@@@`@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.
'                                 @@@@@@@@@@@ @@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
'                                :@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                #@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.
'                                @@@@@@@@@@@@`@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
'                               .@@@@@@@@@@@@:#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                               #@@@@@@@@@@@@'#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                               @@@@@@@@@@@@@@;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+
'                               @@@@@@@@@@@@@@:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                              .@@@@@@@@@@@@@@,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                              :@@@@@@@@@@@@@#,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,
'                              '@@@@@@@@@@@@@#:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
'       `,   `                 +@@@@@@@@@@@@@@,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'      `@##@.                  +@@@@@@@@@@@@@@`@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'      '# #`@@`                +@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,
'    `.@  #  #@;               :@@@@@@@@@@@@@@'@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'    `@` +;   :##              ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'     @  @      @@ `           `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'   `@, @.       #@.            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.
'    @ @;         ,@+           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'
'    @ ,            #@`         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
'      `             .@#        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'::                    '@:      ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'         #,`            @@     `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'          '#,            ;@' `  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`
'            ##`         ``.@@`  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#
'             .@#            '@+ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'               #@+`          `@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                `@@' `         ;#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                  :#@.          `@@@@@@@@'  `+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                    #@#`          `#@@+       +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@' ,;;#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                     .@@:           ,@@        +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'  @@@@'.@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                       +@@            #@`      `;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@# #@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@
'                         @#,           #@        .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@:@@@@@@@@@@@@@@@@@@@@@@@@
'                          ;@@`          @'        `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@'#@@@@@@@@@@@@@@@@@@@@@@
'                            +@#`        `@`         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;@@@@@@@@@@@@@@@@,@@@@@@@@@@@@@@@@@@@@@
'                             `@@@:       ;@          #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;.`     :'@+,.@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@
'                               ,@@@@@@@@@@@.          +#@@@@@@@@@@@@@@@@@@@@@@#@#, `..#@@@@@:` `@@,  +#@@@@@@@@@@#@@@@@@@@@@@@@@@@@@@
'                                :..+@@@@@@@+           :@@@@@@@@@@@@@@@@@+;+',.;#@@@@@@@@@@@@@@. +@@+` #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.
'                                 .`   `;#@@@.           .@@@@#:.````     `,@@@@@@@@@@@@@@@@@@@@@# .@@@; ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@+
'                                  @;                      '`     ,+@@@@@@@`+@@@@@@@@@@@@@@@@@@@@@@`.@@@# ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                   @+                     `.@@@@@@@@@@@@@@# @@@@@@@@@@@@@@@@@@@@@@@`.@@@@`.@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                    @#                      ;@@@@@@@@@@@@@@+,@@@@@@@@@@@@@@@@@@@@@@@,;@@@#,.@@@@@@@@@@@@@@@@@@@@@@@@@@`
'                                     @#                      @@@@@@@@@@@@@@@`@@@@@@@@@@@@@@@@@@@@@@@@+@@@@@.,@@@@@@@@@@@@@@@@@@@@@@@@@.
'                                     '#+                      @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+@@@@@@@@@@@@@@@@@@@@@@@@@.
'                                      @;'`                    +@@@@@@@@@@@@@@.+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`
'                                      `@   .;@@+               @@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`
'                                    @@@@#      ,.              @@@@@@@@@@@@@@@:;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`
'                                    '@@@@;     `,              #@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`
'                                    .@@@@@.                    `@@@@@@@@@@@@@@@;:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                     @@@@@@.`.+, `              @@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                     @@@@@@@`` :`+              @@@@@@@@@@@@@@@@,#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                     @@@@@@@@+:,+,              @@@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                     #@@@@@@@@@@@@@@@@'         @@@@@@@@@@@@@@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                     ;@@@@@@@@@@@@@@@@@@@'.    .@@@@@@@@@@@@@@@@@`@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+
'                                     `@@@@@@@@@@@@@@@@@@@@@@`  #@@@@@@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,
'                                      @@@@@@@@@@@@@@@@@@@@@@@@'`       `.#@@@@@@@,#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                      #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#;,.`    ,#@@;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
'                                      ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+':.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

Option Explicit
Dim sText, Path, sOutput, lngPos, lngLen, value, num, strText, strSubstr, FileMD5 As String
Dim iLocationOfString1, iLocationOfString2, iCompareStyle, y, SizeFile As Long
Dim f As Integer
Dim bytz As Byte

Private Sub Command1_Click()
If Text2.Text = "" Then
MsgBox "Nothing to copy", vbInformation, "Oops"
Else
   Clipboard.Clear
   Clipboard.SetText Text2.Text
End If
End Sub

Private Sub Form_Load()
Me.OLEDropMode = 1  'Manual Ole Drop Mode
Text3.Text = "Pony gate extractor 0.1, Please drag'n'drop a file" & vbCrLf
Me.Picture = LoadPicture("")
End Sub

Private Sub Form_OLEDragDrop(Data As DataObject, _
                              Effect As Long, _
                              Button As Integer, _
                              Shift As Integer, _
                              X As Single, _
                              y As Single)
  With Data
    sText = ""
    value = ""
    Text1.Text = ""
    Text2.Text = ""
    strText = ""
    Text2.Text = ""
    
    If .GetFormat(vbCFFiles) Then
      If .Files.Count = 1 Then
        'Only one filename was dragged.  Retrieve it.
        Path = .Files(1)  'Note numeral 1.
        Text4.Text = .Files(1)  'to pass it later to hashing module
        Text3.Text = Text3.Text & "[" & Time & "] Loading: " & Path & vbCrLf

    ' If file exists...
    If Dir$(Path) <> vbNullString Then
        ' display its size.
        SizeFile = FileLen(Path)
    End If
    
    ' FileSize checks
    If SizeFile < 63000 Then
        Text3.Text = Text3.Text & "[!] Exiting: Bad filesize < 63000" & vbCrLf
        Text3.SelStart = Len(Text3.Text) 'multipleline textbox auto scroll down
        Exit Sub
    End If
    
    If SizeFile > 100000 Then
        Text3.Text = Text3.Text & "[!] Exiting: Bad filesize > 100000" & vbCrLf
        Text3.SelStart = Len(Text3.Text) 'multipleline textbox auto scroll down
        Exit Sub
    End If
        
    If SizeFile = "0" Then
        Text3.Text = Text3.Text & "[!] Exiting: Shit hapenned with filesize" & vbCrLf
        Text3.SelStart = Len(Text3.Text) 'multipleline textbox auto scroll down
        Exit Sub
    End If

    ' Pull text file data into our textbox.
        f = FreeFile
Open Path For Binary As #f
For y = 63000 To 76000
Get #f, y, bytz
    strText = strText & Right("0" & Hex$(bytz), 2) '& " " 'Display the file as Hexadecimal
    DoEvents
Next y

Text1.Text = strText ' Add into txtbox
Close #f

lngPos = InStr(Text1.Text, "0068747470") 'Look for a nullbyte and 'http'
If lngPos = 0 Then
    Text3.Text = Text3.Text & "[!] Exiting: no URL to exploit" & vbCrLf
    Text3.SelStart = Len(Text3.Text) 'Multipleline textbox auto scroll down
    Exit Sub
Else
End If

lngPos = InStr(Text1.Text, "59554950574446494C4530595549504B4446494C45305955494352595054454430595549312E30") 'YUIPWDFILE0YUIPKDFILE0YUICRYPTED0YUI1.0
If lngPos = 0 Then
    Text3.Text = Text3.Text & "[!] Exiting: Magic bytes not found" & vbCrLf
    Text3.SelStart = Len(Text3.Text) 'Multipleline textbox auto scroll down
    Exit Sub
Else
    Text3.Text = Text3.Text & "[*] Sound like pony, attempting to extract..." & vbCrLf
End If

Text2 = "68747470" & funcParseStringFromString2String(Text1, "0068747470", "0000000000000000000000000000") '00 68 74 74 70 = http
Text2 = Text2.Text & "0" 'Adding a zero for completing the last hex code because we removed it the line before (terrible programming)
Text2 = hex2ascii(Text2) 'Hexadecimal to ascii

' Output treatment (just to display some informations)
lngPos = InStr(8, Text2.Text, "/")
strSubstr = Left$(Text2.Text, lngPos)
strSubstr = Replace$(strSubstr, "http://", "")
strSubstr = Replace$(strSubstr, "/", "")
FileMD5 = GetMD5(Text4.Text)
Text3.Text = Text3.Text & "[*] Callback: " & UCase$(strSubstr) & " - Size: " & SizeFile & " -   MD5: " & FileMD5 & vbCrLf

lngPos = InStr(Text1.Text, "0068747470")
Text1.Text = Right$(Text1.Text, lngPos)
Text3.Text = Text3.Text & "[*] Finished" & vbCrLf
      If .Files.Count > 1 Then
      Exit Sub ' Dude, wtf are you doing here ?
      End If
    End If
  End If
End With

Text3.SelStart = Len(Text3.Text) 'multipleline textbox auto scroll down
End Sub

Public Function hex2ascii(ByVal hextext As String) As String
For y = 1 To Len(hextext)
    num = Mid(hextext, y, 2)
    value = value & Chr(Val("&h" & num))
    y = y + 1
Next y

hex2ascii = value
hextext = ""
End Function
    
Function funcParseStringFromString2String(sSourceString, sString1 As String, sString2 As String, Optional fCaseCaseInsensitive As Boolean = False) As String
 If fCaseCaseInsensitive Then
iCompareStyle = vbTextCompare
 Else
iCompareStyle = vbBinaryCompare
 End If
 
 sOutput = sSourceString
 iLocationOfString1 = InStr(1, sOutput, sString1, iCompareStyle)
 iLocationOfString2 = InStr(1, sOutput, sString2, iCompareStyle)
 If iLocationOfString1 = 0 And iLocationOfString2 = 0 Then
'nothing found
sOutput = ""
 Else
If Len(sString1) = 0 And Len(sString2) = 0 Then
 'do nothing
ElseIf Len(sString1) = 0 Then
 If iLocationOfString2 <> 0 Then
sOutput = Mid(sOutput, 1, iLocationOfString2 - 1)
 End If
ElseIf Len(sString2) = 0 Then
 sOutput = Mid(sOutput, iLocationOfString1 + Len(sString1))
Else
 'cut off begining
 If iLocationOfString1 <> 0 Then
sOutput = Mid(sOutput, iLocationOfString1 + Len(sString1))
 End If
 'take off the end part
 iLocationOfString2 = InStr(1, sOutput, sString2, iCompareStyle)
 If iLocationOfString2 <> 0 Then
sOutput = Mid(sOutput, 1, iLocationOfString2 - 1)
 End If
End If
 End If
 funcParseStringFromString2String = sOutput
End Function
